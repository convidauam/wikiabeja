<!--
title: Editor CONVIDA
description: Pagina principal del editor convida
published: true
date: 2025-08-16T03:31:28.185Z
tags: editor
editor: ckeditor
dateCreated: 2025-03-26T02:14:46.829Z
-->

<h1>Editor CONVIDA</h1>
<p>El Editor Convida es un componente del proyecto Convida que permitirá a quien lo utilice describir la estructura teórica de un cierto campo de saberes a través de un lenguaje visual consistente en elementos simbólicos e icónicos. Su objetivo, además de generar una representación gráfica de las estructuras teóricas, es incorporar restricciones provenientes tanto de la lógica y la teoría de conjuntos, como de la filosofía de las ciencias, a fin de fomentar la generación de estructuras con significado y que puedan ser útiles tanto para la enseñanza, como para la reflexión teórica.</p>
<p>Para lograr estos objetivos, el Editor Convida presentará tres distintas vistas:</p>
<ul>
  <li>Editor gráfico</li>
  <li>Código fuente</li>
  <li>Vista previa</li>
</ul>
<p>&nbsp;</p>
<h3>Editor gráfico</h3>
<p>Se propone la creación de un programa, alojado en el navegador, que permita al usuario generar diagramas, tales como las representaciones gráficas propuestas, en un entorno visual. Este navegador podrá ser desarrollado en Godot Engine o en alguna otra plataforma.&nbsp;</p>
<p>Se plantea de momento el desarrollo de este programa mediante el uso de <a href="https://reactflow.dev/">React Flow</a>, &nbsp;una biblioteca diseñada para la construcción de aplicaciones basadas en nodos. <sup>1</sup> React Flow es a su vez, un componente modificable de <a href="https://react.dev/">React.js</a> ,otra biblioteca Javascript. Es requerido como base para emplear estas bibliotecas el uso de <a href="https://nodejs.org/es">Node.js</a>, un entorno de ejecución de JavaScript multiplataforma.&nbsp;</p>
<p>Adicionalmente, para el desarrollo de este editor se emplea el editor de código fuente <a href="https://code.visualstudio.com/ ">Visual Studio Code</a> y el servidor de desarrollo local <a href="https://vite.dev/">Vite</a>.&nbsp;</p>
<figure class="image image_resized" style="width:48.78%;"><img src="/dragramaseditorjs.png">
  <figcaption>Diagrama de dependencia del software propuesto.</figcaption>
</figure>
<p>React Flow, React.js y Node.js son software de código abierto.</p>
<p>&nbsp;</p>
<h5>Recursos utilizados por el proyecto</h5>
<ul>
  <li><strong>React</strong> (librería principal para construir la interfaz)</li>
  <li><strong>TypeScript</strong> (superset de JavaScript con tipado estático)</li>
  <li><strong>React Flow</strong> (librería para diagramas y flujos interactivos)</li>
  <li><strong>Material-UI (MUI)</strong> (sistema de componentes de UI)</li>
  <li><strong>npm</strong> (gestor de paquetes de Node.js)</li>
</ul>
<p>&nbsp;</p>
<h4>Configuración en Visual Studio Code</h4>
<p>Requisitos previos:</p>
<ul>
  <li>Tener instalado <a href="https://git-scm.com/downloads">Git</a></li>
  <li>Tener instalado <a href="https://nodejs.org/">Node.js</a> (incluye npm)</li>
  <li>Tener instalado <a href="https://code.visualstudio.com/">Visual Studio Code (VS Code)</a></li>
</ul>
<p>&nbsp;</p>
<p>Posteriormente, se crea importa el repositorio desde Github usando la terminal integrada de VsCode</p>
<p><code>git clone https://github.com/CONVIDA/Editor.git</code></p>
<p>Se navega a la carpeta del proyecto en la terminal con:</p>
<p><code>cd EditorJSv2</code></p>
<p>Se instalan las dependecias necesarias con:</p>
<p><code>npm install</code></p>
<p>Y se ejecuta la el siguiente comando para ejecutar la aplicación en modo desarrollo y normalmente abrirá tu navegador en un localhost como <a href="http://localhost:3000">http://localhost:3000</a></p>
<p><code>npm start</code></p>
<p>Para terminar el poroceso se presiona<code> Crt+C</code> en la terminal y <code>Y</code></p>
<p>&nbsp;</p>
<p>Algunas de las funciones que presenta actualmente el editor gráfico son:</p>
<p>&nbsp;</p>
<figure class="image image_resized" style="width:45.43%;"><img src="/nodosyligas.gif.gif">
  <figcaption>Conectar y mover nodos</figcaption>
</figure>
<p>&nbsp;</p>
<figure class="image image_resized" style="width:45.39%;"><img src="/guardadoeditor.gif">
  <figcaption>Guardado del diagrama muestra en fomato png y json</figcaption>
</figure>
<h2>Funcionalidades</h2>
<p>Las funcionalidades actuales del editor gráfico son:</p>
<ul>
  <li>Crear nodos, editar su color y texto</li>
  <li>Crear conexiones entre nodos, editar su aspectyo y añadir etiquetas.</li>
  <li>Exportar los diagramas en archivos json, png y svg</li>
</ul>
<p>Queda corregir:</p>
<ul>
  <li>Conexiones con las anclas laterales de los nodos</li>
</ul>
<p>A implementar:</p>
<ul>
  <li>Función de importar y leer archivos json</li>
  <li>Aspecto de flecha (direccional) para las conexiones</li>
  <li>Posibles tipos de nodo</li>
  <li>Nodos- imagen<ul>
      <li>Banco de iconos, con barra lateral para importarlos.</li>
      <li>(codificar cada imagen con nombre)</li>
    </ul>
  </li>
</ul>
<p>&nbsp;</p>
<h2>Arquitectura</h2>
<p>&nbsp;</p>
<h4>1.Estructura de Carpetas</h4>
<p><strong>src/</strong></p>
<p>&nbsp;Carpeta principal con todo el código fuente:</p>
<p><strong>components/</strong></p>
<p>&nbsp; &nbsp;Componentes React reutilizables, por ejemplo: Toolbar, DiagramCanvas.</p>
<p><strong>utils/</strong></p>
<p>&nbsp; &nbsp;Funciones utilitarias para exportar, generar IDs, etc.</p>
<p><strong>hooks/</strong></p>
<p>&nbsp; &nbsp;Hooks personalizados, por ejemplo, `useDiagram` para manejar el estado y lógica de los diagramas.</p>
<p><strong>theme/</strong></p>
<p>&nbsp; &nbsp;Temas para la aplicación (por defecto, tema oscuro).</p>
<p><strong>index.tsx / App.tsx</strong></p>
<p>&nbsp; &nbsp;Entrada principal y montaje de la app React.</p>
<p><strong>public/</strong></p>
<p>&nbsp;Contiene archivos estáticos (index.html, manifest, favicon, etc.).</p>
<p>&nbsp;</p>
<h4>2. Funcionamiento General</h4>
<p><strong>React Flow</strong></p>
<p>&nbsp;El núcleo de la aplicación usa la librería [reactflow](https://reactflow.dev/) para renderizar y manipular diagramas de flujo. Los nodos y conexiones (edges) se gestionan con estados internos y hooks personalizados.</p>
<p><strong>Hooks Personalizados (`useDiagram`)</strong></p>
<p>&nbsp;Encapsulan toda la lógica relacionada con los diagramas:</p>
<p>&nbsp;- Gestión de nodos y conexiones.</p>
<p>&nbsp;- Acciones como agregar, borrar, duplicar nodos/edges.</p>
<p>&nbsp;- Manejo de eventos de edición y contexto (menús contextuales).</p>
<p>&nbsp;- Exportación e importación de diagramas.</p>
<p><strong>Componentes UI</strong></p>
<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; Toolbar:</strong></p>
<p>&nbsp; &nbsp;Barra superior con botones para exportar los diagramas en diferentes formatos. &nbsp;</p>
<p>&nbsp; &nbsp;Ejemplo: Exportar JSON utiliza la función `exportToJson` de `utils/export.ts`.</p>
<p><strong>&nbsp; &nbsp; &nbsp;DiagramCanvas:</strong></p>
<p>&nbsp; &nbsp;Área donde se renderizan y manipulan los nodos y conexiones visualmente.</p>
<p><strong>&nbsp; &nbsp;Exportación de Diagramas&nbsp;</strong></p>
<p>&nbsp; &nbsp; &nbsp;JSON: Serializa el estado actual del diagrama y lo descarga como archivo local.</p>
<p>&nbsp; &nbsp; &nbsp; PNG/SVG: Captura la imagen del diagrama y la descarga usando utilidades como `html-to-image`.</p>
<p>&nbsp;</p>
<h4>3. **Misceláneo**</h4>
<p><strong>- **Estilo y Temas:** &nbsp;</strong></p>
<p>&nbsp;Utiliza Material UI y un tema oscuro personalizado.</p>
<p><strong>- **Gestión de IDs:** &nbsp;</strong></p>
<p>&nbsp;Los nodos y edges tienen IDs generados única y automáticamente con utilidades propias.</p>
<p><strong>- **Extensibilidad:** &nbsp;</strong></p>
<p>&nbsp;El código está modularizado para permitir agregar más temas, tipos de nodos, funcionalidad de exportación, etc.</p>
<hr>
<p>&nbsp;</p>
<h2>## Para comunicación con Backend:</h2>
<p>&nbsp;</p>
<h4><strong>Función de importación y lectura de los JSON:</strong></h4>
<p>&nbsp;</p>
<p><strong>Función de importacicon y lectura de los JSON:</strong></p>
<p><strong>Hook personalizado:</strong></p>
<ul>
  <li>Archivo: <code>src/hooks/useDiagram.ts</code></li>
  <li>Función: <code>importFromJson(file: File)</code></li>
</ul>
<p><strong>Barra de herramientas (Toolbar):</strong></p>
<ul>
  <li>Archivo: <code>src/components/Toolbar/Toolbar.tsx</code></li>
  <li>Prop: <code>onImportJson</code></li>
  <li>Handler: <code>handleImportJson</code></li>
</ul>
<p><strong>Uso en el canvas:</strong></p>
<ul>
  <li>Archivo: <code>src/components/Diagram/DiagramCanvas.tsx</code></li>
  <li>Se pasa la función <code>importFromJson</code> como prop a <code>Toolbar</code>.</li>
</ul>
<p>&nbsp;</p>
<h4><strong>Función de exportación de JSON:</strong></h4>
<p><strong>Funcion de exportación de JSON:</strong> Se llama <code><strong>exportToJson</strong></code> y se encuentra en:</p>
<pre><code class="language-plaintext">src/utils/export.ts
</code></pre>
<p>Funcionamiento general</p>
<p>La función <code>exportToJson</code> recibe dos parámetros:</p>
<p>Una instancia de React Flow (<code>reactFlowInstance</code>), que contiene el estado actual del diagrama.</p>
<p>Un nombre de archivo (opcional, por defecto: <code>'diagrama.json'</code>).</p>
<p><strong>Convierte el diagrama:</strong> Utiliza el método <code>.toObject()</code> de la instancia para obtener los datos del diagrama (nodos, conexiones, posiciones, etc.).</p>
<p><strong>Serializa a JSON:</strong> Usa <code>JSON.stringify</code> para convertir los datos a texto JSON legible.</p>
<p><strong>Prepara la descarga:</strong> Crea un elemento <code>&lt;a&gt;</code> (enlace) temporal, configura su atributo <code>href</code> con el contenido JSON codificado y <code>download</code> con el nombre de archivo.</p>
<p><strong>Dispara la descarga:</strong> Añade el enlace al DOM, simula un clic y luego lo elimina, logrando que el navegador descargue el archivo JSON.</p>
<p>En la Interfaz: en el componente de la barra de herramientas (<code>src/components/Toolbar/Toolbar.tsx</code>), hay un botón llamado "Exportar JSON".<br>Cuando el usuario hace clic en ese botón, se llama a un handler como <code>handleExportJson</code>, que a su vez invoca la función <code>exportToJson</code> pasando la instancia actual del diagrama.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Bibliografía</h2>
<ol>
  <li>Introdución a React Flow <a href="https://reactflow.dev/learn/concepts/introduction"><u>https://reactflow.dev/learn/concepts/introduction</u></a></li>
  <li>&nbsp;</li>
</ol>
<h2>Ligas útiles</h2>
<ul>
  <li><a href="https://docs.godotengine.org/en/stable/tutorials/ui/index.html">Documentación de Godot Engine para Interfaz de Usuario (UI)</a></li>
  <li><a href="https://github.com/excalidraw/excalidraw">Excalidraw</a></li>
  <li>Ejemplo de editor de diagramas interactivos basado en React Flow <a href="https://ameliorate.app/">Ameliorate.</a></li>
  <li>Ejemplo de construcción de un <a href="https://reactflow.dev/learn/tutorials/mind-map-app-with-react-flow">editor de diagramas básico con React Flow</a></li>
</ul>
<h2>Responsables</h2>
<ul>
  <li>Sonia Pérez</li>
</ul>
